<div class="contenedor">

    <div class="contenido">

        <!-- MENSAJE ÉXITO -->
        @if (mensajeExito) {
        <div class="alerta-exito">
            {{ mensajeExito }}
        </div>
        }

        <!-- ENCABEZADO -->
        <header class="encabezado">
            <div>
                <h1>Proyectos</h1>
                <p class="subtitulo">
                    Gestión de proyectos y asignación de artefactos
                </p>
            </div>

            <button class="btn-nuevo" (click)="abrirModal()">
                + Nuevo Proyecto
            </button>
        </header>

        <!-- BUSCADOR -->
        <div class="barra-superior">
            <input
                type="text"
                placeholder="Buscar proyectos..."
                [(ngModel)]="textoBusqueda" />
        </div>

        <!-- SIN PROYECTOS -->
        @if (!proyectosFiltrados.length) {
        <div class="tarjeta">
            <h3>No hay proyectos</h3>
            <p>Comienza creando tu primer proyecto</p>
            <button class="btn-crear" (click)="abrirModal()">
                + Crear Proyecto
            </button>
        </div>
        }

        <!-- LISTA -->
        @if (proyectosFiltrados.length) {
        <div class="lista">
            @for (proyecto of proyectosFiltrados; track proyecto.id) {
            <div class="item"
                [class.proyecto-nuevo]="proyecto.id === ultimoProyectoId">

                <h4>{{ proyecto.nombre }}</h4>
                <p>{{ proyecto.descripcion }}</p>

            </div>
            }
        </div>
        }

    </div>

</div>

<!-- MODAL -->
@if (modalAbierto) {
<div class="modal-overlay" (click)="cerrarModal()">

    <div class="modal" (click)="$event.stopPropagation()">

        <div class="modal-header">
            <h2>Nuevo Proyecto</h2>
            <span class="cerrar" (click)="cerrarModal()">×</span>
        </div>

        <div class="modal-body">

            <label>Nombre de la Empresa *</label>
            <input
                type="text"
                [(ngModel)]="nuevoProyecto.empresa"
                [class.input-error]="!nuevoProyecto.empresa.trim() && modalAbierto" />

            <label>Nombre del Proyecto *</label>
            <input
                type="text"
                [(ngModel)]="nuevoProyecto.nombre"
                [class.input-error]="!nuevoProyecto.nombre.trim() && modalAbierto" />

            <label>Descripción General *</label>
            <textarea
                rows="3"
                [(ngModel)]="nuevoProyecto.descripcion"
                [class.input-error]="!nuevoProyecto.descripcion.trim() && modalAbierto">
        </textarea>

        </div>

        <div class="modal-footer">
            <button class="btn-cancelar" (click)="cerrarModal()">
                Cancelar
            </button>

            <button
                class="btn-crear"
                [disabled]="!formularioValido()"
                (click)="guardarProyecto()">

                Crear Proyecto
            </button>
        </div>

    </div>

</div>
}

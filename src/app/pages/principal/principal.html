<div class="pagina">
    <!-- HEADER -->
    <header class="encabezado">
        <div class="encabezado__izq">
            <div class="logo">
                <div class="logo__marca">R</div>
                <div class="logo__texto">
                    <div class="logo__titulo">Requify</div>
                    <div class="logo__subtitulo">Gesti√≥n de Requerimientos</div>
                </div>
            </div>
        </div>

        <div class="encabezado__der">
            <div class="usuario">
                <div class="usuario__nombre">{{ usuario().nombre }}</div>
                <div class="usuario__rol">{{ usuario().rol }}</div>
            </div>

            <button type="button" class="btn btn--secundario"
                (click)="cerrarSesion()">
                <span class="btn__icono">‚á¶</span>
                Cerrar Sesi√≥n
            </button>
        </div>
    </header>

    <!-- CONTENIDO -->
    <main class="contenido">
        <section class="titulo">
            <h1>Tus Proyectos</h1>
            <p>Selecciona un proyecto para continuar o crea uno nuevo</p>
        </section>

        <section class="grid">
            <!-- CARD: CREAR NUEVO -->
            <button type="button" class="card card--crear"
                (click)="abrirModalCrear()">
                <div class="card--crear__borde">
                    <div class="card--crear__centro">
                        <div class="plus">
                            <span>+</span>
                        </div>
                        <div class="card--crear__titulo">Crear Nuevo
                            Proyecto</div>
                        <div class="card--crear__desc">Comienza un nuevo
                            proyecto de requerimientos</div>
                    </div>
                </div>
            </button>

            <!-- LISTA DE PROYECTOS -->
            <div class="lista">
                <article
                    class="card card--proyecto"
                    *ngFor="let p of proyectos()"
                    (click)="abrirProyecto(p)"
                    tabindex="0"
                    role="button"
                    (keydown.enter)="abrirProyecto(p)"
                    (keydown.space)="abrirProyecto(p)">
                    <div class="card--proyecto__fila1">
                        <div class="icono-proyecto" aria-hidden="true">üìÅ</div>
                        <div class="flecha" aria-hidden="true">‚Ä∫</div>
                    </div>

                    <div class="card--proyecto__nombre">{{ p.nombre }}</div>
                    <div class="card--proyecto__desc">{{ p.descripcion }}</div>

                    <div class="chips">
                        <div class="chip chip--claro">
                            <span class="chip__icono">‚öôÔ∏è</span>
                            <span class="chip__texto">Procesos</span>
                            <span class="chip__num">{{ p.procesos }}</span>
                        </div>
                        <div class="chip chip--azul">
                            <span class="chip__icono">üë•</span>
                            <span class="chip__texto">Stakeholders</span>
                            <span class="chip__num">{{ p.stakeholders }}</span>
                        </div>
                    </div>

                    <div class="fecha">
                        <span class="fecha__icono">üóìÔ∏è</span>
                        <span>Creado: {{ p.creadoEl }}</span>
                    </div>
                </article>
            </div>
        </section>

        <!-- BOT√ìN AYUDA -->
        <button class="ayuda" type="button" aria-label="Ayuda">?</button>
    </main>

    <!-- MODAL CREAR PROYECTO -->
    <div class="overlay" *ngIf="estaModalAbierta()" (click)="cerrarModal()">
        <div
            class="modal"
            role="dialog"
            aria-modal="true"
            aria-labelledby="tituloModal"
            (click)="$event.stopPropagation()"
            (keydown)="onKeydownModal($event)"
            tabindex="0">
            <div class="modal__header">
                <div class="modal__titulo">
                    <div class="modal__icono">üüß</div>
                    <h2 id="tituloModal">Crear Nuevo Proyecto</h2>
                </div>

                <button type="button" class="modal__cerrar"
                    (click)="cerrarModal()" aria-label="Cerrar">√ó</button>
            </div>

            <div class="modal__body">
                <label class="campo">
                    <span class="campo__label">Nombre del Proyecto
                        <b>*</b></span>
                    <input
                        class="campo__input"
                        type="text"
                        placeholder="Ej: Sistema de Gesti√≥n Hospitalaria"
                        [formControl]="form.controls.nombre" />
                    <span class="campo__error"
                        *ngIf="form.controls.nombre.touched && form.controls.nombre.invalid">
                        Ingresa un nombre v√°lido (m√≠nimo 3 caracteres).
                    </span>
                </label>

                <label class="campo">
                    <span class="campo__label">Descripci√≥n General</span>
                    <textarea
                        class="campo__textarea"
                        rows="3"
                        placeholder="Describe brevemente el proyecto y sus objetivos..."
                        [formControl]="form.controls.descripcion"></textarea>
                </label>

                <div class="consejo">
                    <span class="consejo__icono">üí°</span>
                    <div class="consejo__texto">
                        <b>Consejo:</b> Un buen nombre de proyecto debe ser
                        claro y descriptivo.
                        Podr√°s agregar procesos, stakeholders y t√©cnicas de
                        recopilaci√≥n despu√©s de crearlo.
                    </div>
                </div>
            </div>

            <div class="modal__footer">
                <button type="button" class="btn btn--secundario"
                    (click)="cerrarModal()">Cancelar</button>
                <button type="button" class="btn btn--primario"
                    (click)="crearProyecto()" [disabled]="estaCreando()">
                    Crear Proyecto
                </button>
            </div>
        </div>
    </div>
</div>
